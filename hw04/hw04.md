hw04
================
Xinzhe Dong
October 4, 2017

### load the packages

    ## Loading tidyverse: ggplot2
    ## Loading tidyverse: tibble
    ## Loading tidyverse: tidyr
    ## Loading tidyverse: readr
    ## Loading tidyverse: purrr
    ## Loading tidyverse: dplyr

    ## Conflicts with tidy packages ----------------------------------------------

    ## filter(): dplyr, stats
    ## lag():    dplyr, stats

### 1. General data reshaping and relationship to aggregation

Activity \#2

Make a tibble with one row per year and columns for life expectancy for two or more countries. Use knitr::kable() to make this table look pretty in your rendered homework. Take advantage of this new data shape to scatterplot life expectancy for one country against that of another.

``` r
# get (average) life expectancy for two countries over years
(lifeexp_Canada <- filter(gapminder,country=="Canada")%>%
    group_by(year)%>%
    summarize(lifeExp))
```

    ## # A tibble: 12 x 2
    ##     year lifeExp
    ##    <int>   <dbl>
    ##  1  1952  68.750
    ##  2  1957  69.960
    ##  3  1962  71.300
    ##  4  1967  72.130
    ##  5  1972  72.880
    ##  6  1977  74.210
    ##  7  1982  75.760
    ##  8  1987  76.860
    ##  9  1992  77.950
    ## 10  1997  78.610
    ## 11  2002  79.770
    ## 12  2007  80.653

``` r
(lifeexp_Australia <- filter(gapminder,country=="Australia")%>%
    group_by(year)%>%
    summarize(lifeExp))
```

    ## # A tibble: 12 x 2
    ##     year lifeExp
    ##    <int>   <dbl>
    ##  1  1952  69.120
    ##  2  1957  70.330
    ##  3  1962  70.930
    ##  4  1967  71.100
    ##  5  1972  71.930
    ##  6  1977  73.490
    ##  7  1982  74.740
    ##  8  1987  76.320
    ##  9  1992  77.560
    ## 10  1997  78.830
    ## 11  2002  80.370
    ## 12  2007  81.235

``` r
# Construct a tibble that joins `lifeexp_Canada` and `lifeexp_Australia`.

year_lifeexp <- full_join(lifeexp_Canada,lifeexp_Australia, by="year")
year_lifeexp
```

    ## # A tibble: 12 x 3
    ##     year lifeExp.x lifeExp.y
    ##    <int>     <dbl>     <dbl>
    ##  1  1952    68.750    69.120
    ##  2  1957    69.960    70.330
    ##  3  1962    71.300    70.930
    ##  4  1967    72.130    71.100
    ##  5  1972    72.880    71.930
    ##  6  1977    74.210    73.490
    ##  7  1982    75.760    74.740
    ##  8  1987    76.860    76.320
    ##  9  1992    77.950    77.560
    ## 10  1997    78.610    78.830
    ## 11  2002    79.770    80.370
    ## 12  2007    80.653    81.235

``` r
year_lifeexp%>%
    kable("html",caption="Life Expectancy for Canada and Australia")%>%
    kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Life Expectancy for Canada and Australia
</caption>
<thead>
<tr>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
lifeExp.x
</th>
<th style="text-align:right;">
lifeExp.y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1952
</td>
<td style="text-align:right;">
68.750
</td>
<td style="text-align:right;">
69.120
</td>
</tr>
<tr>
<td style="text-align:right;">
1957
</td>
<td style="text-align:right;">
69.960
</td>
<td style="text-align:right;">
70.330
</td>
</tr>
<tr>
<td style="text-align:right;">
1962
</td>
<td style="text-align:right;">
71.300
</td>
<td style="text-align:right;">
70.930
</td>
</tr>
<tr>
<td style="text-align:right;">
1967
</td>
<td style="text-align:right;">
72.130
</td>
<td style="text-align:right;">
71.100
</td>
</tr>
<tr>
<td style="text-align:right;">
1972
</td>
<td style="text-align:right;">
72.880
</td>
<td style="text-align:right;">
71.930
</td>
</tr>
<tr>
<td style="text-align:right;">
1977
</td>
<td style="text-align:right;">
74.210
</td>
<td style="text-align:right;">
73.490
</td>
</tr>
<tr>
<td style="text-align:right;">
1982
</td>
<td style="text-align:right;">
75.760
</td>
<td style="text-align:right;">
74.740
</td>
</tr>
<tr>
<td style="text-align:right;">
1987
</td>
<td style="text-align:right;">
76.860
</td>
<td style="text-align:right;">
76.320
</td>
</tr>
<tr>
<td style="text-align:right;">
1992
</td>
<td style="text-align:right;">
77.950
</td>
<td style="text-align:right;">
77.560
</td>
</tr>
<tr>
<td style="text-align:right;">
1997
</td>
<td style="text-align:right;">
78.610
</td>
<td style="text-align:right;">
78.830
</td>
</tr>
<tr>
<td style="text-align:right;">
2002
</td>
<td style="text-align:right;">
79.770
</td>
<td style="text-align:right;">
80.370
</td>
</tr>
<tr>
<td style="text-align:right;">
2007
</td>
<td style="text-align:right;">
80.653
</td>
<td style="text-align:right;">
81.235
</td>
</tr>
</tbody>
</table>
### 2. Join, merge, look up

Create a second data frame, complementary to Gapminder. Join this with Gapminder using a dplyr join function and make some observations about the process and result. Explore the different types of joins.

**The second data frame**:

One row per continent("Asia", "Oceania", "Europe", "Antarctica"), a continent variable and two more variable with extra info. One is areas of continents, in square miles, and another one is northern versus southern hemisphere.

``` r
(extra_infor <- data.frame(continent=c("Asia", "Oceania", "Europe", "Antarctica"),
                     areas=c(17139445, 2967909, 3997929, 5405000),
                     hemisphere = c("northern", "southern", "northern", "southern")) %>% 
     as.tbl)
```

    ## # A tibble: 4 x 3
    ##    continent    areas hemisphere
    ##       <fctr>    <dbl>     <fctr>
    ## 1       Asia 17139445   northern
    ## 2    Oceania  2967909   southern
    ## 3     Europe  3997929   northern
    ## 4 Antarctica  5405000   southern

**1. To the `gapminder` dataset, add the "areas" and "hemisphere" variable using the `extra_infor` tibble.**

``` r
gapminder%>%
  left_join(extra_infor, by = "continent")
```

    ## Warning: Column `continent` joining factors with different levels, coercing
    ## to character vector

    ## # A tibble: 1,704 x 8
    ##        country continent  year lifeExp      pop gdpPercap    areas
    ##         <fctr>     <chr> <int>   <dbl>    <int>     <dbl>    <dbl>
    ##  1 Afghanistan      Asia  1952  28.801  8425333  779.4453 17139445
    ##  2 Afghanistan      Asia  1957  30.332  9240934  820.8530 17139445
    ##  3 Afghanistan      Asia  1962  31.997 10267083  853.1007 17139445
    ##  4 Afghanistan      Asia  1967  34.020 11537966  836.1971 17139445
    ##  5 Afghanistan      Asia  1972  36.088 13079460  739.9811 17139445
    ##  6 Afghanistan      Asia  1977  38.438 14880372  786.1134 17139445
    ##  7 Afghanistan      Asia  1982  39.854 12881816  978.0114 17139445
    ##  8 Afghanistan      Asia  1987  40.822 13867957  852.3959 17139445
    ##  9 Afghanistan      Asia  1992  41.674 16317921  649.3414 17139445
    ## 10 Afghanistan      Asia  1997  41.763 22227415  635.3414 17139445
    ## # ... with 1,694 more rows, and 1 more variables: hemisphere <fctr>

**2. To the `gapminder` dataset, add the "areas" and "hemisphere" variable using the `extra_infor` tibble, but only keeping obervations for which areas and hemisphere are available.**

``` r
gapminder%>%
  inner_join(extra_infor, by = "continent")
```

    ## Warning: Column `continent` joining factors with different levels, coercing
    ## to character vector

    ## # A tibble: 780 x 8
    ##        country continent  year lifeExp      pop gdpPercap    areas
    ##         <fctr>     <chr> <int>   <dbl>    <int>     <dbl>    <dbl>
    ##  1 Afghanistan      Asia  1952  28.801  8425333  779.4453 17139445
    ##  2 Afghanistan      Asia  1957  30.332  9240934  820.8530 17139445
    ##  3 Afghanistan      Asia  1962  31.997 10267083  853.1007 17139445
    ##  4 Afghanistan      Asia  1967  34.020 11537966  836.1971 17139445
    ##  5 Afghanistan      Asia  1972  36.088 13079460  739.9811 17139445
    ##  6 Afghanistan      Asia  1977  38.438 14880372  786.1134 17139445
    ##  7 Afghanistan      Asia  1982  39.854 12881816  978.0114 17139445
    ##  8 Afghanistan      Asia  1987  40.822 13867957  852.3959 17139445
    ##  9 Afghanistan      Asia  1992  41.674 16317921  649.3414 17139445
    ## 10 Afghanistan      Asia  1997  41.763 22227415  635.3414 17139445
    ## # ... with 770 more rows, and 1 more variables: hemisphere <fctr>

**3. Output the rows in `extra_infor` corresponding to continents that *are not* found in the `gapminder` dataset.**

``` r
extra_infor%>%
  anti_join(gapminder, by = "continent")
```

    ## Warning: Column `continent` joining factors with different levels, coercing
    ## to character vector

    ## # A tibble: 1 x 3
    ##    continent   areas hemisphere
    ##       <fctr>   <dbl>     <fctr>
    ## 1 Antarctica 5405000   southern

**4. Output the rows in `extra_infor` corresponding to continents that *are* found in the `gapminder` dataset.**

``` r
extra_infor%>%
  semi_join(gapminder, by = "continent")
```

    ## Warning: Column `continent` joining factors with different levels, coercing
    ## to character vector

    ## # A tibble: 3 x 3
    ##   continent    areas hemisphere
    ##      <fctr>    <dbl>     <fctr>
    ## 1      Asia 17139445   northern
    ## 2   Oceania  2967909   southern
    ## 3    Europe  3997929   northern

**5. Construct a tibble that joins `gapminder` and `extra_infor`, so that all rows found in each original tibble are also found in the final tibble.**

``` r
full_join(gapminder,extra_infor, by = "continent")
```

    ## Warning: Column `continent` joining factors with different levels, coercing
    ## to character vector

    ## # A tibble: 1,705 x 8
    ##        country continent  year lifeExp      pop gdpPercap    areas
    ##         <fctr>     <chr> <int>   <dbl>    <int>     <dbl>    <dbl>
    ##  1 Afghanistan      Asia  1952  28.801  8425333  779.4453 17139445
    ##  2 Afghanistan      Asia  1957  30.332  9240934  820.8530 17139445
    ##  3 Afghanistan      Asia  1962  31.997 10267083  853.1007 17139445
    ##  4 Afghanistan      Asia  1967  34.020 11537966  836.1971 17139445
    ##  5 Afghanistan      Asia  1972  36.088 13079460  739.9811 17139445
    ##  6 Afghanistan      Asia  1977  38.438 14880372  786.1134 17139445
    ##  7 Afghanistan      Asia  1982  39.854 12881816  978.0114 17139445
    ##  8 Afghanistan      Asia  1987  40.822 13867957  852.3959 17139445
    ##  9 Afghanistan      Asia  1992  41.674 16317921  649.3414 17139445
    ## 10 Afghanistan      Asia  1997  41.763 22227415  635.3414 17139445
    ## # ... with 1,695 more rows, and 1 more variables: hemisphere <fctr>

**6. Subset the `gapminder` dataset to have continents that are only found in the `extra_infor` data frame.**

``` r
gapminder%>%
  semi_join(extra_infor)
```

    ## Joining, by = "continent"

    ## Warning: Column `continent` joining factors with different levels, coercing
    ## to character vector

    ## # A tibble: 780 x 6
    ##        country continent  year lifeExp      pop gdpPercap
    ##         <fctr>    <fctr> <int>   <dbl>    <int>     <dbl>
    ##  1 Afghanistan      Asia  1952  28.801  8425333  779.4453
    ##  2 Afghanistan      Asia  1957  30.332  9240934  820.8530
    ##  3 Afghanistan      Asia  1962  31.997 10267083  853.1007
    ##  4 Afghanistan      Asia  1967  34.020 11537966  836.1971
    ##  5 Afghanistan      Asia  1972  36.088 13079460  739.9811
    ##  6 Afghanistan      Asia  1977  38.438 14880372  786.1134
    ##  7 Afghanistan      Asia  1982  39.854 12881816  978.0114
    ##  8 Afghanistan      Asia  1987  40.822 13867957  852.3959
    ##  9 Afghanistan      Asia  1992  41.674 16317921  649.3414
    ## 10 Afghanistan      Asia  1997  41.763 22227415  635.3414
    ## # ... with 770 more rows

**7. Subset the `gapminder` dataset to have continents that are *not* found in the `extra_infor` data frame.**

``` r
gapminder%>%
  anti_join(extra_infor)
```

    ## Joining, by = "continent"

    ## Warning: Column `continent` joining factors with different levels, coercing
    ## to character vector

    ## # A tibble: 924 x 6
    ##    country continent  year lifeExp      pop gdpPercap
    ##     <fctr>    <fctr> <int>   <dbl>    <int>     <dbl>
    ##  1 Algeria    Africa  1952  43.077  9279525  2449.008
    ##  2 Algeria    Africa  1957  45.685 10270856  3013.976
    ##  3 Algeria    Africa  1962  48.303 11000948  2550.817
    ##  4 Algeria    Africa  1967  51.407 12760499  3246.992
    ##  5 Algeria    Africa  1972  54.518 14760787  4182.664
    ##  6 Algeria    Africa  1977  58.014 17152804  4910.417
    ##  7 Algeria    Africa  1982  61.368 20033753  5745.160
    ##  8 Algeria    Africa  1987  65.799 23254956  5681.359
    ##  9 Algeria    Africa  1992  67.744 26298373  5023.217
    ## 10 Algeria    Africa  1997  69.152 29072015  4797.295
    ## # ... with 914 more rows
